---
layout: default
title: API - Connection
---

<h1>Connection</h1>

<p>
  A <code>Connection</code> instance represents a single connection to a database server.
</p>

<p>
  Only one request at a time may be executed on a connection.

  Once a <a href="api-request.html"><code>Request</code></a> has been initiated
  (with <a href="#function_callProcedure"><code>callProcedure</code></a>,
  <a href="#function_execSql"><code>execSql</code></a>, or
  <a href="#function_execSqlBatch"><code>execSqlBatch</code></a>),
  another should not be initiated until the <code>Request</code>'s completion callback is called.
</p>

<ul class="toc">
  <li><a href="#function_newConnection">new Connection(config)</a></li>
  <li><a href="#event_connect">Event: 'connect'</a></li>
  <li><a href="#event_end">Event: 'end'</a></li>
  <li><a href="#event_error">Event: 'error'</a></li>
  <li><a href="#event_debug">Event: 'debug'</a></li>
  <li><a href="#event_infoMessage">Event: 'infoMessage'</a></li>
  <li><a href="#event_errorMessage">Event: 'errorMessage'</a></li>
  <li><a href="#event_databaseChange">Event: 'databaseChange'</a></li>
  <li><a href="#event_languageChange">Event: 'languageChange'</a></li>
  <li><a href="#event_charsetChange">Event: 'charsetChange'</a></li>
  <li><a href="#event_secure">Event: 'secure'</a></li>
  <li><a href="#function_connect">connection.connect(callback)</a></li>
  <li><a href="#function_beginTransaction">connection.beginTransaction(callback, [name], [isolationLevel])</a></li>
  <li><a href="#function_callProcedure">connection.callProcedure(request)</a></li>
  <li><a href="#function_cancel">connection.cancel()</a></li>
  <li><a href="#function_close">connection.close()</a></li>
  <li><a href="#function_commitTransaction">connection.commitTransaction(callback)</a></li>
  <li><a href="#function_execSql">connection.execSql(request)</a></li>
  <li><a href="#function_execSqlBatch">connection.execSqlBatch(request)</a></li>
  <li><a href="#function_execBulkLoad">connection.execBulkLoad(bulkLoad)</a></li>
  <li><a href="#function_execute">connection.execute(request, parameters)</a></li>
  <li><a href="#function_prepare">connection.prepare(request)</a></li>
  <li><a href="#function_reset">connection.reset(callback)</a></li>
  <li><a href="#function_rollbackTransaction">connection.rollbackTransaction(callback, [name])</a></li>
  <li><a href="#function_saveTransaction">connection.saveTransaction(callback)</a></li>
  <li><a href="#function_transaction">connection.transaction(callback)</a></li>
  <li><a href="#function_unprepare">connection.unprepare(request)</a></li>
  <li><a href="#function_newBulkLoad">connection.newBulkLoad(tableName, callback)</a></li>
</ul>

<h2 id="function_newConnection">new Connection(config)</h2>
{% highlight javascript %}
var Connection = require('tedious').Connection;
var config = {
  "authentication": {
    ...,
    "options": {...}
  },

  "options": {
    ...
  }
};
var connection = new Connection(config);

// Setup event handler when the connection is established. 
connection.on('connect', function(err) {
  if(err) {
    console.log('Error: ', err)
  }
  // If no error, then good to go...
  executeStatement();
});

// Initialize the connection.
connection.connect();
{% endhighlight %}

<div class="argument">
  <div class="name">config</div>
  <div class="description">

    <p>Note: be aware of the different options field: <br>
        <dd>1) config.authentication.options</dd>
        <dd>2) config.options</dd> 
    </p>

    <dl>
      <dt>
        <code>server</code>
      </dt>
      <dd>
        Hostname to connect to.
      </dd>

      <dt>
        <code>authentication.type</code>
      </dt>
      <dd>
        Type of the authentication method, valid types are <code>default</code>, <code>ntlm</code>,
        <code>azure-active-directory-default</code>, <code>azure-active-directory-password</code>, 
        <code>azure-active-directory-access-token</code>, <code>azure-active-directory-msi-vm</code>, 
        <code>azure-active-directory-msi-app-service</code>, or <code>azure-active-directory-service-principal-secret</code>
        <ul>
          <li><code>azure-active-directory-default</code></li>
          <p>
            This uses <code>DefaultAzureCredential</code> to try multiple methods of authentication. You can find 
            more information on what values to provide and how to provide them from 
            <a href="https://docs.microsoft.com/en-us/javascript/api/overview/azure/identity-readme?view=azure-node-latest#defaultazurecredential">this Microsoft document.</a>
          </p>
{% highlight javascript %}
"authentication": {
  "type":'azure-active-directory-default',
  ...,
  "options": {
    "clientId": value (Optional)
  }
}           
{% endhighlight %}
          <ul>
            <li>clientId (string): The (`client`) ID of the user you want to log in with.</li>
          </ul>
          <li><code>azure-active-directory-password</code></li>
{% highlight javascript %}
"authentication": {
  "type":'azure-active-directory-password',
  ...,
  "options": {
    "userName": value,
    "password": value,
    "clientId": value,
    "tenantId": value (Optional)
  }
}           
{% endhighlight %}
          <ul>
            <li>username (string): A user needs to provide the `userName` associated to their account.</li>
            <li>password (string): A user needs to provide the `password` associated to their account.</li>
            <li>clientId (string): Application (`client`) ID from your registered Azure application. 
              The application has to have public client flows enabled and has to have `user_impersonation` 
              permissions for Azure SQL Database. The user account that is being used also has to be assigned
              to the application, and has to grant consent (either explicitly or via admin consent).
              Note: the previously provided default client ID will expire in the near future and stop working.
            </li>
            <li>tenantId (string): Optional parameter for specific Azure tenant ID. (default: <code>common</code>).
              If your server does not support the <code>/common</code> endpoint, please provide a tenantId.
              Note: this used to be called <code>domain</code>. 
              <code>domain</code> will proceed to work but will be removed in the near future.
            </li>
          </ul>
          <li><code>azure-active-directory-access-token</code></li>
{% highlight javascript %}
"authentication": {
  "type":'azure-active-directory-access-token',
  ...,
  "options": {
    "token": value
  }
}         
{% endhighlight %}
          <ul>
            <li>token (string): A user needs to provide the `token` which they retrieved elsewhere to forming the connection.</li>
            <p>
              <h4>Best Practices</h4>
              Tedious supports an authentication type: <code>azure-active-directory-password</code>. 
              This is the recommended method because Tedious will handle the process of retrieving the Azure token 
              internally instead of requiring the user to manually retrieve the token as shown below.
            </p>
            <p>
              <h4>How to get the token</h4>
              There are different approaches if a user actually needs to retrieve a token manually.
              The details can be found in Microsoft documentation. Here are some examples:
              <ul>
                <li> Retrieving the token within an msi-app-service using a PowerShell script: <a href="https://docs.microsoft.com/en-us/azure/app-service/overview-managed-identity?tabs=dotnet" target="_blank"><i><b>here</b></i></a>.</li>
                <li> Retrieving the token within an msi-vm using a PowerShell script: <a href="https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/how-to-use-vm-token#get-a-token-using-powershell" target="_blank"><i><b>here</b></i></a>.</li>
                <li> Retrieving the token within a JavaScript script: <a href="https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/how-to-use-vm-token#get-a-token-using-powershell" target="_blank"><i><b>here</b></i></a>.</li>
              </ul>   
            </p>
          </ul>
          </ul>
<li><code>azure-active-directory-msi-vm</code></li>
{% highlight javascript %}
"authentication": {
  "type":'azure-active-directory-msi-vm',
  ...,
  "options": {
    "clientId": value,
    "msiEndpoint": value
  }
    
}           
{% endhighlight %}
          <ul>
            <li>clientId (string): If a user wants to connect to an Azure app service using a specific client account, the user must provide a `clientId` that is associated with their created identity. This is optional for retrieving the token from the Azure web app service.
            </li>
            <li>msiEndpoint (string):  A user needs to provide the `msiEndpoint` for retriving the access token.</li>
          </ul>          
<li><code>azure-active-directory-msi-app-service</code></li>
{% highlight javascript %}
"authentication": {
  "type":'azure-active-directory-msi-app-service',
  ...,
  "options": {
    "clientId": value,
    "msiEndpoint": value,
    "msiSecret": value
  }
}           
{% endhighlight %}   
          <ul>
            <li>clientId (string): If a user wants to connect to an Azure app service using a specific client account, the user must provide a `clientId` that is associated with their created identity. This is optional for retrieving the token from the Azure web app service.
            </li>
            <li>
              msiEndpoint (string):  An msi app service environment needs to provide the `msiEndpoint` to retrieve the access token.
            </li>
            <li>msiSecret (string):  An msi app service environment needs to provide the `msiSecret` to retrieve the access token.</li>
          </ul>          
<li><code>azure-active-directory-service-principal-secret</code></li>
{% highlight javascript %}
"authentication": {
  "type":'azure-active-directory-service-principal-secret',
  ...,
  "options": {
    "clientId": value,
    "clientSecret": value,
    "tenantId": (Optional)
  }
}           
{% endhighlight %}   
          <ul>
            <li>clientId (string): Application (`client`) ID from your registered Azure application.</li>
            <li>clientSecret (string): The created `client secret` for this registered Azure application.</li>
            <li>tenantId (string): Directory (`tenant`) ID from your registered Azure application.</li>
          </ul>                  
        </ul>
        <li><code>NTLM</code></li>
        <ul>
          <dd>If using NTLM with node 17 or newer, the <code>--openssl-legacy-provider</code> command line flag must be enabled, else an error will be thrown. Check the <a href="./frequently-encountered-problems.html">FAQ</a> for more information.</dd>
        </ul>
      </dd>

      <dt>
        <code>authentication.options.userName</code>
      </dt>
      <dd>
        User name to use for authentication.
      </dd>

      <dt>
        <code>authentication.options.password</code>
      </dt>
      <dd>
        Password to use for authentication.
      </dd>

      <dt>
        <code>authentication.options.domain</code>
      </dt>
      <dd>
        Once you set domain for ntlm authentication type, driver will connect to SQL Server using domain login.
      </dd>

      <dt>
        <code>authentication.options.token</code>
      </dt>
      <dd>
        When using azure-active-directory-access-token authentication type, this is the access token to use for
        authentication.
      </dd>

      <dt>
        <code>authentication.options.clientId</code>
      </dt>
      <dd>
        When using azure-active-directory-msi-app-service (optional), azure-active-directory-msi-vm (optional), 
        or azure-active-directory-service-principal-secret authentication type, this is the Application (client) 
        ID of the identity to use for authentication.
      </dd>

      <dt>
        <code>authentication.options.clientSecret</code>
      </dt>
      <dd>
        When using azure-active-directory-service-principal-secret authentication type, this is a secret 
        associated with the clientId to use for authentication.
      </dd>

      <dt>
        <code>options.abortTransactionOnError</code>
      </dt>
      <dd>
        A boolean determining whether to rollback a transaction automatically if any error is encountered
        during the given transaction's execution. This sets the value for <code>SET XACT_ABORT</code> during the
        initial SQL phase of a connection (<a href="http://msdn.microsoft.com/en-us/library/ms188792.aspx"
          target="_blank">documentation</a>).
      </dd>

      <dt>
        <code>options.appName </code>
      </dt>
      <dd>
        Application name used for identifying a specific application in profiling, logging or tracing tools of SQL
        Server. (default: <code>Tedious</code>)
      </dd>

      <dt>
        <code>options.camelCaseColumns</code>
      </dt>
      <dd>
        A boolean, controlling whether the column names returned will have the first letter converted to lower case
        (<code>true</code>) or not. This value is ignored if you provide a <code>columnNameReplacer</code>.
        (default: <code>false</code>).
      </dd>

      <dt>
        <code>options.cancelTimeout</code>
      </dt>
      <dd>
        The number of milliseconds before the cancel (abort) of a request is considered failed
        (default: <code>5000</code>).
      </dd>
      
      <dt>
        <code>options.columnNameReplacer</code>
      </dt>
      <dd>
        A function with parameters <code>(columnName, index, columnMetaData)</code> and returning a string. If provided,
        this will be called once per column per result-set. The returned value will be used instead of the SQL-provided
        column name on row and meta data objects. This allows you to dynamically convert between naming conventions.
        (default: <code>null</code>).
      </dd>

      <dt>
        <code>options.connectionRetryInterval</code>
      </dt>
      <dd>
        Number of milliseconds before retrying to establish connection, in case of transient failure. (default:
        <code>500</code>)
      </dd>
      
      <dt>
        <code>options.connectTimeout</code>
      </dt>
      <dd>
        The number of milliseconds before the attempt to connect is considered failed
        (default: <code>15000</code>).
      </dd>

      <dt>
        <code>options.connectionIsolationLevel</code>
      </dt>
      <dd>
        The default isolation level for new connections. All out-of-transaction queries are executed with this setting.
        The isolation levels are available from <code>require('tedious').ISOLATION_LEVEL</code> .
        <ul>
          <li><code>READ_UNCOMMITTED</code></li>
          <li><code>READ_COMMITTED</code></li>
          <li><code>REPEATABLE_READ</code></li>
          <li><code>SERIALIZABLE</code></li>
          <li><code>SNAPSHOT</code></li>
        </ul>
        (default: <code>READ_COMMITED</code>).
      </dd>

      <dt>
        <code>options.cryptoCredentialsDetails</code>
      </dt>
      <dd>
        When options.encrypt is set to true, an object may be supplied that will be used
        as the <code>secureContext</code> field when calling
        <a href="https://nodejs.org/docs/latest/api/tls.html#class-tlstlssocket">new tls.TLSSocket</a>.
        The available options are listed under <a href="https://nodejs.org/docs/latest/api/tls.html#tlscreatesecurecontextoptions">tls.createSecureContext</a>.
        (default: <code>{}</code>).
      </dd>

      <dt>
        <code>options.database</code>
      </dt>
      <dd>
        Database to connect to (default: dependent on server configuration).
      </dd>

      <dt>
        <code>options.datefirst</code>
      </dt>
      <dd>
        Sets the first day of the week to a number from 1 through 7.
      </dd>

      <dt>
        <code>options.dateFormat</code>
      </dt>
      <dd>
        A string representing position of month, day and year in temporal datatypes. (default: <code>mdy</code>)
      </dd>

      <dt>
        <code>options.debug.packet</code>
      </dt>
      <dd>
        A boolean, controlling whether <code>debug</code> events will be emitted with text describing packet details
        (default: <code>false</code>).
      </dd>

      <dt>
        <code>options.debug.data</code>
      </dt>
      <dd>
        A boolean, controlling whether <code>debug</code> events will be emitted with text describing packet data
        details
        (default: <code>false</code>).
      </dd>

      <dt>
        <code>options.debug.payload</code>
      </dt>
      <dd>
        A boolean, controlling whether <code>debug</code> events will be emitted with text describing packet payload
        details
        (default: <code>false</code>).
      </dd>

      <dt>
        <code>options.debug.token</code>
      </dt>
      <dd>
        A boolean, controlling whether <code>debug</code> events will be emitted with text describing token stream
        tokens
        (default: <code>false</code>).
      </dd>

      <dt>
        <code>options.enableAnsiNull</code>
      </dt>
      <dd>
        A boolean, controls the way null values should be used during comparison operation. (default: <code>true</code>)
      </dd>

      <dt>
        <code>options.enableAnsiNullDefault</code>
      </dt>
      <dd>
        If true, <code>SET ANSI_NULL_DFLT_ON ON</code> will be set in the initial sql. This means new columns will be
        nullable by default. See the <a href="https://msdn.microsoft.com/en-us/library/ms187375.aspx">T-SQL
          documentation</a> for more details.
        (Default: <code>true</code>).
      </dd>

      
      <dt>
        <code>options.enableAnsiPadding</code>
      </dt>
      <dd>
        A boolean, controls if padding should be applied for values shorter than the size of defined column. (default:
        <code>true</code>)
      </dd>

      <dt>
        <code>options.enableAnsiWarnings</code>
      </dt>
      <dd>
        If true, SQL Server will follow ISO standard behavior during various error conditions. For details, see <a
          href="https://docs.microsoft.com/en-us/sql/t-sql/statements/set-ansi-warnings-transact-sql">documentation</a>.
        (default: <code>true</code>)
      </dd>

      <dt>
        <code>options.enableArithAbort</code>
      </dt>
      <dd>
        Ends a query when an overflow or divide-by-zero error occurs during query execution. 
        See <a href="https://docs.microsoft.com/en-us/sql/t-sql/statements/set-arithabort-transact-sql?view=sql-server-2017">documentation</a>
        for more details.
        (default: <code>true</code>)
      </dd>

      <dt>
        <code>options.enableConcatNullYieldsNull</code>
      </dt>
      <dd>
        A boolean, determines if concatenation with NULL should result in NULL or empty string value, more details in <a
          href="https://docs.microsoft.com/en-us/sql/t-sql/statements/set-concat-null-yields-null-transact-sql">documentation</a>.
        (default: <code>true</code>)
      </dd>

      <dt>
        <code>options.enableCursorCloseOnCommit</code>
      </dt>
      <dd>
        A boolean, controls whether cursor should be closed, if the transaction opening it gets committed or rolled
        back. (default: <code>null</code>)
      </dd>

      <dt>
        <code>options.enableImplicitTransactions</code>
      </dt>
      <dd>
        A boolean, sets the connection to either implicit or autocommit transaction mode. (default: <code>false</code>)
      </dd>

      
      <dt>
        <code>options.enableNumericRoundabort</code>
      </dt>
      <dd>
        If false, error is not generated during loss of precession. (default: <code>false</code>)
      </dd>

      
      <dt>
        <code>options.enableQuotedIdentifier </code>
      </dt>
      <dd>
        If true, characters enclosed in single quotes are treated as literals and those enclosed double quotes are
        treated as identifiers. (default: <code>true</code>)
      </dd>

      
      <dt>
        <code>options.encrypt</code>
      </dt>
      <dd>
        A string value set to <code>strict</code> enables the TDS 8.0 protocol. 
        Otherwise, encrypt can be set to a boolean value which determines 
        whether or not the connection will be encrypted under the TDS 7.x protocol. 
        (default: <code>true</code>)
      </dd>

      <dt>
        <code>options.fallbackToDefaultDb</code>
      </dt>
      <dd>
        By default, if the database requested by <code>options.database</code> cannot be accessed,
        the connection will fail with an error. However, if <code>options.fallbackToDefaultDb</code> is
        set to <code>true</code>, then the user's default database will be used instead
        (Default: <code>false</code>).
      </dd>

      <dt>
        <code>options.instanceName</code>
      </dt>
      <dd>
        The instance name to connect to.
        The SQL Server Browser service must be running on the database server,
        and UDP port 1434 on the database server must be reachable.
        <br />
        (no default)
        <br />
        Mutually exclusive with <code>options.port</code>.
      </dd>
      
      <dt>
        <code>options.isolationLevel</code>
      </dt>
      <dd>
        The default isolation level that transactions will be run with.
        The isolation levels are available from <code>require('tedious').ISOLATION_LEVEL</code> .
        <ul>
          <li><code>READ_UNCOMMITTED</code></li>
          <li><code>READ_COMMITTED</code></li>
          <li><code>REPEATABLE_READ</code></li>
          <li><code>SERIALIZABLE</code></li>
          <li><code>SNAPSHOT</code></li>
        </ul>
        (default: <code>READ_COMMITED</code>).
      </dd>
         
      <dt>
        <code>options.language</code>
      </dt>
      <dd>
        Specifies the language environment for the session. The session language determines the datetime formats and system messages.
        (default: <code>us_english</code>).
      </dd>

      <dt>
        <code>options.localAddress</code>
      </dt>
      <dd>
        A string indicating which network interface (ip address) to use when connecting to SQL Server.
      </dd>
      
      <dt>
        <code>options.maxRetriesOnTransientErrors</code>
      </dt>
      <dd>
        The maximum number of connection retries for transient errors. 
        (default: <code>3</code>).
      </dd>

      <dt>
        <code>options.multiSubnetFailover</code>
      </dt>
      <dd>
        Sets the MultiSubnetFailover = True parameter, which can help minimize the client recovery latency when failovers occur.
        (default: <code>false</code>).
      </dd>

      <dt>
        <code>options.packetSize</code>
      </dt>
      <dd>
        The size of TDS packets (subject to negotiation with the server).
        Should be a power of 2.
        (default: <code>4096</code>).
      </dd>  
      
      <dt>
        <code>options.port</code>
      </dt>
      <dd>
        Port to connect to (default: <code>1433</code>).
        <br />
        Mutually exclusive with <code>options.instanceName</code>.
      </dd>

      <dt>
        <code>options.readOnlyIntent</code>
      </dt>
      <dd>
        A boolean, determining whether the connection will request read only access from a SQL Server Availability
        Group. For more information, see <a href="http://msdn.microsoft.com/en-us/library/hh710054.aspx"
          title="Microsoft: Configure Read-Only Routing for an Availability Group (SQL Server)">here</a>.
        (default: <code>false</code>).
      </dd>

      <dt>
        <code>options.requestTimeout</code>
      </dt>
      <dd>
        The number of milliseconds before a request is considered failed, or <code>0</code> for no timeout
        (default: <code>15000</code>).
      </dd>

      <dt>
        <code>options.rowCollectionOnDone</code>
      </dt>
      <dd>
        A boolean, that when true will expose received rows in Requests' <code>done*</code> events.
        See <a href="api-request.html#event_done">done</a>,
        <a href="api-request.html#event_doneInProc">doneInProc</a>
        and <a href="api-request.html#event_doneProc">doneProc</a>.
        (default: <code>false</code>)

        <p>
          Caution: If many row are received, enabling this option could result in
          excessive memory usage.
        </p>
      </dd>

      <dt>
        <code>options.rowCollectionOnRequestCompletion</code>
      </dt>
      <dd>
        A boolean, that when true will expose received rows in Requests' completion callback.
        See <a href="api-request.html#function_newRequest">new Request</a>.
        (default: <code>false</code>)

        <p>
          Caution: If many row are received, enabling this option could result in
          excessive memory usage.
        </p>
      </dd>

      <dt>
        <code>options.tdsVersion</code>
      </dt>
      <dd>
        The version of TDS to use. If server doesn't support specified version, negotiated version is used instead.
        The versions are available from <code>require('tedious').TDS_VERSION</code>.
        <ul>
          <li><code>7_1 (use for SQL Server 2000)</code> </li>
          <li><code>7_2</code></li>
          <li><code>7_3_A</code></li>
          <li><code>7_3_B</code></li>
          <li><code>7_4</code></li>
        </ul>
        (default: <code>7_4</code>).
      </dd>

      <dt>
        <code>options.textsize</code>
      </dt>
      <dd>
        Specifies the size of varchar(max), nvarchar(max), varbinary(max), text, ntext, and image data returned by a SELECT statement.
        (default: <code>2147483647</code>) (Textsize is set by a numeric value.)
      </dd>

      <dt>
        <code>options.trustServerCertificate</code>
      </dt>
      <dd>
        If "true", the SQL Server SSL certificate is automatically trusted when the communication layer is encrypted using SSL.

        If "false", the SQL Server validates the server SSL certificate. If the server certificate validation fails, 
        the driver raises an error and terminates the connection. Make sure the value passed to serverName exactly 
        matches the Common Name (CN) or DNS name in the Subject Alternate Name in the server certificate for an SSL connection to succeed. 
        (default: <code>true</code>).
      </dd>

      <dt>
        <code>options.useColumnNames</code>
      </dt>
      <dd>
        A boolean determining whether to return rows as arrays or key-value collections.
        (default: <code>false</code>).
      </dd>

      <dt>
        <code>options.useUTC</code>
      </dt>
      <dd>
        A boolean determining whether to pass time values in UTC or local time.
        (default: <code>true</code>).
      </dd>

    </dl>
  </div>
</div>

<h2 id="event_connect">Event: 'connect'</h2>
<span class="function">function (err) { }</span>
<p>
  The attempt to connect and validate has completed.
</p>
<div class="argument">
  <div class="name">err</div>
  <div class="description">
    <p>
      If successfully connected, will be falsey.
    </p>
    <p>
      If there was a problem (with either connecting or validation), will be an error object.
    </p>
  </div>
</div>

<h2 id="event_end">Event: 'end'</h2>
<span class="function">function () { }</span>
<p>
  The connection has ended.
  This may be as a result of the client calling <code>close()</code>, the server closing the connection, or a network
  error.
</p>

<h2 id="event_error">Event: 'error'</h2>
<span class="function">function (err) { }</span>
<p>
  Internal error occurs.
</p>

<h2 id="event_debug">Event: 'debug'</h2>
<span class="function">function (messageText) { }</span>
<p>
  A debug message is available.
  It may be logged or ignored.
</p>
<div class="argument">
  <div class="name">messageText</div>
  <div class="description">
    <p>
      The debug message.
    </p>
  </div>
</div>

<h2 id="event_infoMessage">Event: 'infoMessage'</h2>
<span class="function">function (info) { }</span>
<p>
  The server has issued an information message.
</p>
<div class="argument">
  <div class="name">info</div>
  <div class="description">
    <p>
      An object with these properties:
    </p>
    <dl>
      <dt><code>number</code></dt>
      <dd>Error number</dd>
    </dl>
    <dl>
      <dt><code>state</code></dt>
      <dd>The error state, used as a modifier to the error number.</dd>
    </dl>
    <dl>
      <dt><code>class</code></dt>
      <dd>The class (severity) of the error. A class of less than 10 indicates an informational message.</dd>
    </dl>
    <dl>
      <dt><code>message</code></dt>
      <dd>The message text.</dd>
    </dl>
    <dl>
      <dt><code>procName</code></dt>
      <dd>The stored procedure name (if a stored procedure generated the message).</dd>
    </dl>
    <dl>
      <dt><code>lineNumber</code></dt>
      <dd>
        The line number in the SQL batch or stored procedure that caused the error.
        Line numbers begin at 1; therefore, if the line number is not applicable to the message,
        the value of LineNumber will be 0.
      </dd>
    </dl>
  </div>
</div>

<h2 id="event_errorMessage">Event: 'errorMessage'</h2>
<span class="function">function (error) { }</span>
<p>
  The server has issued an error message.
</p>
<div class="argument">
  <div class="name">error</div>
  <div class="description">
    <p>
      An object with the same properties as.listed for the
      <code>infoMessage</code> event.
    </p>
  </div>
</div>


<h2 id="event_databaseChange">Event: 'databaseChange'</h2>
<span class="function">function (databaseName) { }</span>
<p>
  The server has reported that the active database has changed.
  This may be as a result of a successful login, or a <code>use</code> statement.
</p>
<div class="argument">
  <div class="name">databaseName</div>
  <div class="description">
    <p>
      The name of the new active database
    </p>
  </div>
</div>

<h2 id="event_languageChange">Event: 'languageChange'</h2>
<span class="function">function (languageName) { }</span>
<p>
  The server has reported that the language has changed.
</p>
<div class="argument">
  <div class="name">languageName</div>
  <div class="description">
    <p>
      The newly active language.
    </p>
  </div>
</div>

<h2 id="event_charsetChange">Event: 'charsetChange'</h2>
<span class="function">function (charset) { }</span>
<p>
  The server has reported that the charset has changed.
</p>
<div class="argument">
  <div class="name">charset</div>
  <div class="description">
    <p>
      The new charset.
    </p>
  </div>
</div>

<h2 id="event_secure">Event: 'secure'</h2>
<span class="function">function (cleartext) { }</span>
<p>
  A secure connection has been established.
</p>
<div class="argument">
  <div class="name">cleartext</div>
  <div class="description">
    <p>
      The
      <a href="http://nodejs.org/docs/latest/api/tls.html#tls_class_tls_cleartextstream">
        <code>cleartext</code>
      </a>
      stream of a tls SecurePair.
      The <a href="http://nodejs.org/docs/latest/api/tls.html#tls_cleartextstream_getcipher">cipher</a>
      and <a href="http://nodejs.org/docs/latest/api/tls.html#tls_cleartextstream_getpeercertificate">peer
        certificate</a>
      (server certificate) may be inspected if desired.
    </p>
  </div>
</div>

<h2 id="function_connect">connection.connect(callback)</h2>
<p>
  Initialize a connection. 
</p>
<div class="argument">
  <div class="name">callback</div>
  <div class="description">
    <span class="function">function (err) { }</span>
    <p>
      The callback is called when the connection is either successfully created (on a <code>connect</code> event) or has an error (on a <code>error</code> event).
      If an error occurs, then <code>err</code> will describe the error.
      <p>
      </p>
      This parameter is optional, if a user choose to not include this parameter, 
      then they have to call the <code>connection.on('connect', (err) => {});</code>
      to check the connection status. 
    </p>
    <div class="argument">
      <div class="name">err</div>
      <div class="description">
        <p>
          If an error occurs, either a connection error or an aggregate error object will be returned.
          <ul>
            <li>
              If a connection error is returned, then it can be directly logged.
{% highlight javascript %}
console.log('Error: ', err)
{% endhighlight %}   
            </li>
            <li>
              If an aggregate error object is returned, then it needs to be logged as an array of messages.
              Be careful to check the size of the error message array before logging it as an array
{% highlight javascript %}
err.errors.map(error=>console.log('Error: ', err))
{% endhighlight %}
            </li>
          </ul>
        </p>
      </div>
    </div>
  </div>
</div>
<h2 id="function_beginTransaction">connection.beginTransaction(callback, [name], [isolationLevel])</h2>
<p>
  Start a transaction.
</p>
<div class="argument">
  <div class="name">callback</div>
  <div class="description">
    <span class="function">function (err) { }</span>
    <p>
      The callback is called when the request to start the transaction has completed,
      either successfully or with an error.
      If an error occurred then <code>err</code> will describe the error.
    </p>
    <p>
      As only one request at a time may be executed on a connection, another request should not
      be initiated until this callback is called.
    </p>
    <div class="argument">
      <div class="name">err</div>
      <div class="description">
        <p>
          If an error occurred, a string with details of the error.
        </p>
      </div>
    </div>
  </div>
</div>
<div class="argument">
  <div class="name">name</div>
  <div class="description">
    <p>
      A string representing a name to associate with the transaction.
    </p>
    <p>
      Optional, and defaults to an empty string.
      Required when <code>isolationLevel</code> is present.
    </p>
  </div>
</div>
<div class="argument">
  <div class="name">isolationLevel</div>
  <div class="description">
    <p>
      The isolation level that the transaction is to be run with.
      The isolation levels are available from <code>require('tedious').ISOLATION_LEVEL</code> .
      <ul>
        <li><code>READ_UNCOMMITTED</code></li>
        <li><code>READ_COMMITTED</code></li>
        <li><code>REPEATABLE_READ</code></li>
        <li><code>SERIALIZABLE</code></li>
        <li><code>SNAPSHOT</code></li>
      </ul>
    </p>
    <p>
      Optional, and defaults to the Connection's isolation level.
    </p>
  </div>
</div>

<h2 id="function_callProcedure">connection.callProcedure(request)</h2>
<p>
  Call a stored procedure represented by <code>request</code>.
</p>
<div class="argument">
  <div class="name">request</div>
  <div class="description">
    <p>
      A <a href="api-request.html"><code>Request</code></a>
      object representing the request.
    </p>
  </div>
</div>

<h2 id="function_cancel">connection.cancel()</h2>
<p>
  Cancel currently executed request.
</p>

<h2 id="function_close">connection.close()</h2>
<p>
  Closes the connection to the database.
</p>
<p>
  The <a href="#event_end"><code>end</code></a> will be emitted once the connection has been closed.
</p>

<h2 id="function_execSql">connection.execSql(request)</h2>
<p>
  Execute the SQL represented by <code>request</code>.
</p>
<p>
  As <code>sp_executesql</code> is used to execute the SQL, if the same SQL is executed multiples times
  using this function, the SQL Server query optimizer is likely to reuse the execution plan it generates
  for the first execution. This may also result in SQL server treating the request like a stored procedure
  which can result in the <a href="api-request.html#event_doneInProc"><code>doneInProc</code></a> or
  <a href="api-request.html#event_doneProc"><code>doneProc</code></a> events being emitted instead of the
  <a href="api-request.html#event_done"><code>done</code></a> event you might expect. Using
  <code>execSqlBatch</code> will prevent this from occurring but may have a negative performance impact.
</p>
<p>
  Beware of the way that scoping rules apply, and how they may
  <a href="http://weblogs.sqlteam.com/mladenp/archive/2006/11/03/17197.aspx">affect local temp tables</a>.
  If you're running in to scoping issues, then <code>execSqlBatch</code> may be a better choice.
  See also <a href="https://github.com/pekim/tedious/issues/24">issue #24</a>.
</p>
<div class="argument">
  <div class="name">request</div>
  <div class="description">
    <p>
      A <a href="api-request.html"><code>Request</code></a>
      object representing the request.
    </p>
  </div>
</div>

<h2 id="function_commitTransaction">connection.commitTransaction(callback)</h2>
<p>
  Commit a transaction.
</p>
<p>
  There should be an active transaction.
  That is, <a href="#function_beginTransaction"><code>beginTransaction</code></a> should have been previously called.
</p>
<div class="argument">
  <div class="name">callback</div>
  <div class="description">
    <span class="function">function (err) { }</span>
    <p>
      The callback is called when the request to commit the transaction has completed,
      either successfully or with an error.
      If an error occurred then <code>err</code> will describe the error.
    </p>
    <p>
      As only one request at a time may be executed on a connection, another request should not
      be initiated until this callback is called.
    </p>
    <div class="argument">
      <div class="name">err</div>
      <div class="description">
        <p>
          If an error occurred, a string with details of the error.
        </p>
      </div>
    </div>
  </div>
</div>

<h2 id="function_execSqlBatch">connection.execSqlBatch(request)</h2>
<p>
  Execute the SQL batch represented by <code>request</code>.
  There is no param support, and unlike <code>execSql</code>,
  it is not likely that SQL Server will reuse the execution plan it generates for the SQL.
</p>
<p>
  In almost all cases, <code>execSql</code> will be a better choice.
</p>
<div class="argument">
  <div class="name">request</div>
  <div class="description">
    <p>
      A <a href="api-request.html"><code>Request</code></a>
      object representing the request.
    </p>
  </div>
</div>

<h2 id="function_execBulkLoad">connection.execBulkLoad(bulkLoad, rows)</h2>
<p>
  Executes a <a href="bulk-load.html">BulkLoad</a>.
</p>
<div class="argument">
  <div class="name">rows</div>
  <div class="description">
    <p>
      The row data. Accepts objects that implements the <code>Iterable</code> or <code>AsyncIterable</code> interface
      (e.g. a <code>Readable</code> stream or an <code>AsyncGenerator</code>). Each row can either be an array or object.    

      <ul>
          <li> Using an Iterable object
{% highlight javascript %}
const rows = [{col1name: col1data, col2name: col2data, col3name: col3data, ... }, 
              [col1data, col2data, col3data, ...], 
              {col2name: col2data}]
{% endhighlight %}   
        </li>
        <li> Using an AsyncIterable object
{% highlight javascript %}
const rows = Readable.from([{col1name: col1data, col2name: col2data, col3name: col3data, ... }, 
              [col1data, col2data, col3data, ...], 
              {col2name: col2data}])
{% endhighlight %}             

        </li>
      </ul>

    </p>
  </div>
</div>
<h2 id="function_execute">connection.execute(request, parameters)</h2>
<p>
  Execute previously prepared SQL, using the supplied parameters.
</p>
<div class="argument">
  <div class="name">request</div>
  <div class="description">
    <p>
      A previously prepared <a href="api-request.html"><code>Request</code></a>.
    </p>
  </div>
</div>
<div class="argument">
  <div class="name">parameters</div>
  <div class="description">
    <p>
      An object whose names correspond to the names of parameters that were added to the
      <code>request</code> before it was prepared.
      The object's values are passed as the parameters' values when the request is executed.
    </p>
  </div>
</div>

<h2 id="function_prepare">connection.prepare(request)</h2>
<p>
  Prepare the SQL represented by the request.
  The request can then be used in subsequent calls to
  <a href="#function_execute">execute</a> and <a href="#function_unprepare">unprepare</a>
</p>
<div class="argument">
  <div class="name">request</div>
  <div class="description">
    <p>
      A <a href="api-request.html"><code>Request</code></a>
      object representing the request.
    </p>
    <p>
      Parameters only require a name and type.
      Parameter values are ignored.
    </p>
  </div>
</div>

<h2 id="function_reset">connection.reset(callback)</h2>
<p>
  Reset the connection to its initial state.
  Can be useful for connection pool implementations.
</p>
<div class="argument">
  <div class="name">callback</div>
  <div class="description">
    <span class="function">function (err) { }</span>
    <p>
      The callback is called when the connection reset has completed,
      either successfully or with an error.
      If an error occurred then <code>err</code> will describe the error.
    </p>
    <p>
      As only one request at a time may be executed on a connection, another request should not
      be initiated until this callback is called.
    </p>
    <div class="argument">
      <div class="name">err</div>
      <div class="description">
        <p>
          If an error occurred, a string with details of the error.
        </p>
      </div>
    </div>
  </div>
</div>

<h2 id="function_rollbackTransaction">connection.rollbackTransaction(callback)</h2>
<p>
  Rollback a transaction.
</p>
<p>
  There should be an active transaction.
  That is, <a href="#function_beginTransaction"><code>beginTransaction</code></a> should have been previously called.
</p>
<div class="argument">
  <div class="name">callback</div>
  <div class="description">
    <span class="function">function (err) { }</span>
    <p>
      The callback is called when the request to rollback the transaction has completed,
      either successfully or with an error.
      If an error occurred then <code>err</code> will describe the error.
    </p>
    <p>
      As only one request at a time may be executed on a connection, another request should not
      be initiated until this callback is called.
    </p>
    <div class="argument">
      <div class="name">err</div>
      <div class="description">
        <p>
          If an error occurred, a string with details of the error.
        </p>
      </div>
    </div>
  </div>
</div>

<h2 id="function_saveTransaction">connection.saveTransaction(callback)</h2>
<p>
  Set a savepoint within a transaction.
</p>
<p>
  There should be an active transaction.
  That is, <a href="#function_beginTransaction"><code>beginTransaction</code></a> should have been previously called.
</p>
<div class="argument">
  <div class="name">callback</div>
  <div class="description">
    <span class="function">function (err) { }</span>
    <p>
      The callback is called when the request to set a savepoint within the transaction has completed,
      either successfully or with an error.
      If an error occurred then <code>err</code> will describe the error.
    </p>
    <p>
      As only one request at a time may be executed on a connection, another request should not
      be initiated until this callback is called.
    </p>
    <div class="argument">
      <div class="name">err</div>
      <div class="description">
        <p>
          If an error occurred, a string with details of the error.
        </p>
      </div>
    </div>
  </div>
</div>

<h2 id="function_transaction">connection.transaction(callback, name, isolationLevel)</h2>
<p>
  Run the given callback after starting a transaction, and commit or rollback the transaction afterwards.
</p>
<p>
  This is a helper that employs <a href="#function_beginTransaction"><code>beginTransaction</code></a>,
  <a href="#function_commitTransaction"><code>commitTransaction</code></a>,
  <a href="#function_rollbackTransaction"><code>rollbackTransaction</code></a> and
  <a href="#function_saveTransaction"><code>saveTransaction</code></a> to greatly simplify the
  use of database transactions and automatically handle transaction nesting.
</p>
<div class="argument">
  <div class="name">callback</div>
  <div class="description">
    <span class="function">function (err, done) { }</span>
    <p>
      The callback is called when the request to start a transaction (or create a savepoint, in
      the case of a nested transaction) has completed, either successfully or with an error.
      If an error occurred, then <code>err</code> will describe the error.
      If no error occurred, the callback should perform its work and eventually call
      <code>done</code> with an error or null (to trigger a transaction rollback or a
      transaction commit) and an additional completion callback that will be called when the request
      to rollback or commit the current transaction has completed, either successfully or with an error.
      Additional arguments given to <code>done</code> will be passed through to this callback.
    </p>
    <p>
      As only one request at a time may be executed on a connection, another request should not
      be initiated until the completion callback is called.
    </p>
    <div class="argument">
      <div class="name">err</div>
      <div class="description">
        <p>
          Pass null to commit the transaction or not null (an error) when the transaction is to be rolled back.
        </p>
      </div>

      <div class="name">done</div>
      <div class="description">
        <p>
          This is another callback you provide that tedious calls when it has committed the
          transaction or a rollback transaction. It will call done with one or more parameters, namely:
        </p>
        <div class="name">err</div>
        <div class="description">
          <p>an indication of any problems with the final commit request</p>
        </div>
        <div class="name">done</div>
        <div class="description">
          <p>Yet another call back with error as first parameter, followed by variable number of arguments as array.</p>
        </div>
        <div class="name">other</div>
        <div class="description">
          <p>the additional parameters you provided to tedious, which tedious will reflect back to you</p>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="argument">
  <div class="name">name</div>
  <div class="description">
    <p>
      A string representing a name to associate with the transaction.
    </p>
    <p>
      Optional, and defaults to an empty string. In case of a nested transaction, naming the transaction name has no
      effect.
    </p>
  </div>
</div>
<div class="argument">
  <div class="name">isolationLevel</div>
  <div class="description">
    <p>
      The isolation level that the transaction is to be run with.
      The isolation levels are available from <code>require('tedious').ISOLATON_LEVEL</code> .
      <ul>
        <li><code>READ_UNCOMMITTED</code></li>
        <li><code>READ_COMMITTED</code></li>
        <li><code>REPEATABLE_READ</code></li>
        <li><code>SERIALIZABLE</code></li>
        <li><code>SNAPSHOT</code></li>
      </ul>
    </p>
    <p>
      Optional, and defaults to the Connection's isolation level.
    </p>
  </div>
</div>
<p>Here's the actual parameter input of transaction in TypeScript notation:</p>
<code>transaction &lt;T extends (...args: any[]) => void>(cb: (err: Error | null | undefined, txDone?: (err: Error | null | undefined, done: T, ...args: Parameters&lt;T>) => void) => void, isolationLevel?: typeof ISOLATION_LEVEL[keyof typeof ISOLATION_LEVEL])</code>

<h2 id="function_unprepare">connection.unprepare(request)</h2>
<p>
  Release the SQL Server resources associated with a previously prepared request.
</p>
<div class="argument">
  <div class="name">request</div>
  <div class="description">
    <p>
      The request to be unprepared.
    </p>
  </div>
</div>

<h2 id="function_newBulkLoad">connection.newBulkLoad(tableName, options, callback)</h2>
<p>
  Creates a new <a href="bulk-load.html">BulkLoad</a> instance.
</p>
<div class="argument">
  <div class="name">tableName</div>
  <div class="description">
    <p>
      The name of the table to bulk-insert into.
    </p>
  </div>
</div>
<div class="argument">
  <div class="name">options(optional)</div>
  <div class="description">
    <dl>
      <dt>
        <code>checkConstraints</code>
      </dt>
      <dd>
        <p>
          Honors constraints during bulk load, using T-SQL <a href="https://technet.microsoft.com/en-us/library/ms186247(v=sql.105).aspx">CHECK_CONSTRAINTS</a>. (default: <code>false</code>)
        </p>
      </dd>

      <dt>
        <code>fireTriggers</code>
      </dt>
      <dd>
        Honors insert triggers during bulk load, using the T-SQL <a href="https://technet.microsoft.com/en-us/library/ms187640(v=sql.105).aspx">FIRE_TRIGGERS</a>. (default: <code>false</code>)
      </dd>

      <dt>
        <code>keepNulls</code>
      </dt>
      <dd>
        Honors null value passed, ignores the default values set on table, using T-SQL <a href="https://msdn.microsoft.com/en-us/library/ms187887(v=sql.120).aspx">KEEP_NULLS</a>. (default: <code>false</code>)
      </dd>

      <dt>
        <code>tableLock</code>
      </dt>
      <dd>
        Places a bulk update(BU) lock on table while performing bulk load, using T-SQL <a href="https://technet.microsoft.com/en-us/library/ms180876(v=sql.105).aspx">TABLOCK</a>. (default: <code>false</code>)
      </dd>
      </dl>
  </div>
</div>
<div class="argument">
  <div class="name">callback</div>
  <div class="description">
    <span class="function">function (err, rowCount) { }</span>
    <p>
      A function which will be called after the BulkLoad finishes executing. <code>rowCount</code> will equal the
      number of rows inserted.
    </p>
  </div>
</div>
